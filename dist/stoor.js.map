{"version":3,"file":"stoor.js","sources":["../src/in-memory.js","../src/is-supported.js","../src/index.js"],"sourcesContent":["let storage = {}\n\nconst inMemory = {\n  getItem (key) {\n    return storage[key] || null\n  },\n\n  setItem (key, value) {\n    storage[key] = value\n  },\n\n  removeItem (key) {\n    if (key in storage) {\n      return delete storage[key]\n    }\n  },\n\n  clear () {\n    storage = {}\n  }\n}\n\nexport default inMemory\n","// http://stackoverflow.com/a/27081419\nexport default function isSupported (storageType) {\n  if (typeof storageType === 'object') {\n    try {\n      storageType.setItem('localStorage', 1)\n      storageType.removeItem('localStorage')\n      return true\n    } catch (e) {\n      return false\n    }\n  }\n\n  return false\n}\n","import inMemory from './in-memory'\nimport isSupported from './is-supported'\n\nclass Stoor {\n  constructor ({ namespace = '', fallback = inMemory, storage = 'local' } = { }) {\n    if (!(this instanceof Stoor)) {\n      return new Stoor({ namespace, fallback, storage })\n    }\n\n    if (!fallback.getItem || !fallback.setItem || !fallback.removeItem) {\n      throw new Error('Invalid fallback provided')\n    }\n\n    if (typeof window === 'undefined') {\n      this.storage = fallback\n    } else if (storage === 'session') {\n      this.storage = isSupported(window.sessionStorage) ? window.sessionStorage : fallback\n    } else {\n      this.storage = isSupported(window.localStorage) ? window.localStorage : fallback\n    }\n\n    this.namespace = namespace\n  }\n\n  get (key, def = null) {\n    if (Array.isArray(key)) {\n      return key.map(currentKey => {\n        const namespacedKey = `${this.namespace}:${currentKey}`\n        return JSON.parse(this.storage.getItem(namespacedKey))\n      })\n    }\n\n    const namespacedKey = `${this.namespace}:${key}`\n\n    try {\n      const result = JSON.parse(this.storage.getItem(namespacedKey))\n      return result !== null ? result : def\n    } catch (error) {\n      return def\n    }\n  }\n\n  set (key, value) {\n    if (Array.isArray(key)) {\n      return key.map(pair => {\n        const [key, value] = pair\n        const namespacedKey = `${this.namespace}:${key}`\n        this.storage.setItem(namespacedKey, JSON.stringify(value))\n      })\n    } else {\n      const namespacedKey = `${this.namespace}:${key}`\n      this.storage.setItem(namespacedKey, JSON.stringify(value))\n    }\n\n    return this\n  }\n\n  remove (key) {\n    if (Array.isArray(key)) {\n      return key.map(currentKey => {\n        const namespacedKey = `${this.namespace}:${currentKey}`\n        return this.storage.removeItem(namespacedKey)\n      })\n    } else {\n      const namespacedKey = `${this.namespace}:${key}`\n      this.storage.removeItem(namespacedKey)\n    }\n\n    return this\n  }\n\n  clear () {\n    return this.storage.clear()\n  }\n}\n\nexport default Stoor\n"],"names":["let","storage","inMemory","getItem","key","setItem","value","removeItem","clear","isSupported","storageType","e","Stoor","constructor","ref","this","namespace","fallback","Error","window","sessionStorage","localStorage","get","def","Array","isArray","map","currentKey","JSON","parse","namespacedKey","result","error","set","pair","stringify","remove"],"mappings":"AAAAA,IAAIC,EAAU,GAERC,EAAW,CACfC,iBAASC,UACAH,EAAQG,IAAQ,MAGzBC,iBAASD,EAAKE,GACZL,EAAQG,GAAOE,GAGjBC,oBAAYH,MACNA,KAAOH,gBACKA,EAAQG,IAI1BI,iBACEP,EAAU,KCjBC,SAASQ,EAAaC,MACR,iBAAhBA,aAEPA,EAAYL,QAAQ,eAAgB,GACpCK,EAAYH,WAAW,iBAChB,EACP,MAAOI,UACA,SAIJ,ECTT,IAAMC,EACJC,WAAaC,kBAA6D,qCAA/C,oCAAeZ,qCAAoB,WACtDa,gBAAgBH,UACb,IAAIA,EAAM,WAAEI,WAAWC,UAAUhB,QAGrCgB,EAASd,UAAYc,EAASZ,UAAYY,EAASV,iBAChD,IAAIW,MAAM,kCAIXjB,QADe,oBAAXkB,OACMF,EACM,YAAZhB,EACMQ,EAAYU,OAAOC,gBAAkBD,OAAOC,eAAiBH,EAE7DR,EAAYU,OAAOE,cAAgBF,OAAOE,aAAeJ,OAGrED,UAAYA,GAGnBM,YAAAA,aAAKlB,EAAKmB,gCAAM,MACVC,MAAMC,QAAQrB,UACTA,EAAIsB,aAAIC,UAENC,KAAKC,MAAMd,EAAKd,QAAQE,QADNY,gBAAkBY,UAKzCG,EAAmBf,mBAAkBX,UAGnC2B,EAASH,KAAKC,MAAMd,KAAKd,QAAQE,QAAQ2B,WAC7B,OAAXC,EAAkBA,EAASR,EAClC,MAAOS,UACAT,IAIXU,YAAAA,aAAK7B,EAAKE,qBACJkB,MAAMC,QAAQrB,GACTA,EAAIsB,aAAIQ,KAGRjC,QAAQI,QADYU,qBACWa,KAAKO,yBAItClC,QAAQI,QADYU,mBAAkBX,EACPwB,KAAKO,UAAU7B,IAG9CS,OAGTqB,YAAAA,gBAAQhC,qBACFoB,MAAMC,QAAQrB,GACTA,EAAIsB,aAAIC,UAENZ,EAAKd,QAAQM,WADKQ,gBAAkBY,WAKxC1B,QAAQM,WADYQ,mBAAkBX,GAItCW,OAGTP,YAAAA,wBACSO,KAAKd,QAAQO"}