{"version":3,"file":"stoor.umd.js","sources":["../src/in-memory.js","../src/is-supported.js","../src/index.js"],"sourcesContent":["let storage = {}\n\nconst inMemory = {\n  getItem (key) {\n    return storage[key] || null\n  },\n\n  setItem (key, value) {\n    storage[key] = value\n  },\n\n  removeItem (key) {\n    if (key in storage) {\n      return delete storage[key]\n    }\n  },\n\n  clear () {\n    storage = {}\n  }\n}\n\nexport default inMemory\n","// http://stackoverflow.com/a/27081419\nexport default function isSupported (storageType) {\n  if (typeof storageType === 'object') {\n    try {\n      storageType.setItem('localStorage', 1)\n      storageType.removeItem('localStorage')\n      return true\n    } catch (e) {\n      return false\n    }\n  }\n\n  return false\n}\n","import inMemory from './in-memory'\nimport isSupported from './is-supported'\n\nclass Stoor {\n  constructor ({ namespace = '', fallback = inMemory, storage = 'local' } = { }) {\n    if (!(this instanceof Stoor)) {\n      return new Stoor({ namespace, fallback, storage })\n    }\n\n    if (!fallback.getItem || !fallback.setItem || !fallback.removeItem) {\n      throw new Error('Invalid fallback provided')\n    }\n\n    if (typeof window === 'undefined') {\n      this.storage = fallback\n    } else if (storage === 'session') {\n      this.storage = isSupported(window.sessionStorage) ? window.sessionStorage : fallback\n    } else {\n      this.storage = isSupported(window.localStorage) ? window.localStorage : fallback\n    }\n\n    this.namespace = namespace\n  }\n\n  get (key = '', def = null) {\n    if (typeof key !== 'string' || !key.length) {\n      throw new Error('Invalid key provided')\n    }\n\n    if (Array.isArray(key)) {\n      return key.map(currentKey => {\n        const namespacedKey = `${this.namespace}:${currentKey}`\n        return JSON.parse(this.storage.getItem(namespacedKey))\n      })\n    }\n\n    const namespacedKey = `${this.namespace}:${key}`\n\n    try {\n      const result = JSON.parse(this.storage.getItem(namespacedKey))\n      return result !== null ? result : def\n    } catch (error) {\n      return def\n    }\n  }\n\n  set (key, value) {\n    if (typeof key !== 'string' || !key.length) {\n      throw new Error('Invalid key provided')\n    }\n\n    if (key && value === undefined) {\n      throw new Error('Can not set value to undefined')\n    }\n\n    if (Array.isArray(key)) {\n      return key.map(pair => {\n        const [key, value] = pair\n        const namespacedKey = `${this.namespace}:${key}`\n        this.storage.setItem(namespacedKey, JSON.stringify(value))\n      })\n    } else {\n      const namespacedKey = `${this.namespace}:${key}`\n      this.storage.setItem(namespacedKey, JSON.stringify(value))\n    }\n\n    return this\n  }\n\n  remove (key) {\n    if (Array.isArray(key)) {\n      return key.map(currentKey => {\n        const namespacedKey = `${this.namespace}:${currentKey}`\n        return this.storage.removeItem(namespacedKey)\n      })\n    } else {\n      const namespacedKey = `${this.namespace}:${key}`\n      this.storage.removeItem(namespacedKey)\n    }\n\n    return this\n  }\n\n  clear () {\n    return this.storage.clear()\n  }\n}\n\nexport default Stoor\n"],"names":["let","storage","inMemory","getItem","key","setItem","value","removeItem","clear","isSupported","storageType","e","Stoor","constructor","ref","this","namespace","fallback","Error","window","sessionStorage","localStorage","get","def","length","Array","isArray","map","currentKey","JSON","parse","namespacedKey","result","error","set","undefined","pair","stringify","remove"],"mappings":"oKAAAA,IAAIC,EAAU,GAERC,EAAW,CACfC,iBAASC,UACAH,EAAQG,IAAQ,MAGzBC,iBAASD,EAAKE,GACZL,EAAQG,GAAOE,GAGjBC,oBAAYH,MACNA,KAAOH,gBACKA,EAAQG,IAI1BI,iBACEP,EAAU,KCjBC,SAASQ,EAAaC,MACR,iBAAhBA,aAEPA,EAAYL,QAAQ,eAAgB,GACpCK,EAAYH,WAAW,iBAChB,EACP,MAAOI,UACA,SAIJ,ECTT,IAAMC,EACJC,WAAaC,kBAA6D,qCAA/C,oCAAeZ,qCAAoB,WACtDa,gBAAgBH,UACb,IAAIA,EAAM,WAAEI,WAAWC,UAAUhB,QAGrCgB,EAASd,UAAYc,EAASZ,UAAYY,EAASV,iBAChD,IAAIW,MAAM,kCAIXjB,QADe,oBAAXkB,OACMF,EACM,YAAZhB,EACMQ,EAAYU,OAAOC,gBAAkBD,OAAOC,eAAiBH,EAE7DR,EAAYU,OAAOE,cAAgBF,OAAOE,aAAeJ,OAGrED,UAAYA,UAGnBM,YAAAA,aAAKlB,EAAUmB,gCAAJ,mBAAU,MACA,iBAARnB,IAAqBA,EAAIoB,aAC5B,IAAIN,MAAM,2BAGdO,MAAMC,QAAQtB,UACTA,EAAIuB,aAAIC,UAENC,KAAKC,MAAMf,EAAKd,QAAQE,QADNY,gBAAkBa,UAKzCG,EAAmBhB,mBAAkBX,UAGnC4B,EAASH,KAAKC,MAAMf,KAAKd,QAAQE,QAAQ4B,WAC7B,OAAXC,EAAkBA,EAAST,EAClC,MAAOU,UACAV,IAIXW,YAAAA,aAAK9B,EAAKE,iBACW,iBAARF,IAAqBA,EAAIoB,aAC5B,IAAIN,MAAM,2BAGdd,QAAiB+B,IAAV7B,QACH,IAAIY,MAAM,yCAGdO,MAAMC,QAAQtB,GACTA,EAAIuB,aAAIS,KAGRnC,QAAQI,QADYU,qBACWc,KAAKQ,yBAItCpC,QAAQI,QADYU,mBAAkBX,EACPyB,KAAKQ,UAAU/B,IAG9CS,OAGTuB,YAAAA,gBAAQlC,qBACFqB,MAAMC,QAAQtB,GACTA,EAAIuB,aAAIC,UAENb,EAAKd,QAAQM,WADKQ,gBAAkBa,WAKxC3B,QAAQM,WADYQ,mBAAkBX,GAItCW,OAGTP,YAAAA,wBACSO,KAAKd,QAAQO"}